<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Han.css/CSS -->
    <link rel="stylesheet" media="all" href="https://cdnjs.cloudflare.com/ajax/libs/Han/3.2.7/han.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Work+Sans:400,700&display=swap" rel="stylesheet">
    <!-- GitHub tag JS -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!-- Bulma -->
    <link rel="stylesheet" media="all" href="https://cdn.jsdelivr.net/npm/bulma@0.8.2/css/bulma.min.css">
    <!-- Marked -->
    <script src="marked.js"></script>

    <style>

        body {
            color: black;
        }

        code {
            color: black;
        }

        .header {
            padding: 32px 0;
            text-align: start;
            margin: 0 24px;
        }

        .header * {
            font-family: 'Work Sans', sans-serif !important;
        }

        h2 {
            height: 28px;
            /*margin-bottom: 0px !important;*/
            max-lines: 1;
            font-family: 'Work Sans', sans-serif !important;
        }

        .content {
            margin: 0 8px;
        }


        #columns {
            height: calc(100% - 160px);
        }

        .column {
            float: left;
            height: 100%;
            width: 50%;
        }

        .code {
            font-family: "Roboto Mono", "SF Mono", Menlo, Courier, monospace !important;
            font-size: 0.8em;
            line-height: 1.4;
        }

        .textarea-wrapper {
            position: relative;
        }

        .textarea-wrapper button {
            position: absolute;
            bottom: 8px;
            right: 15px;
        }

        .textarea-wrapper textarea {
            padding-bottom: 4em;
        }

        .checkbox, .checkbox * {
            font-family: 'Work Sans', sans-serif !important;
        }

        #markdown {
            margin: 0 8px;
            height: 50%;
        }

        #markdown-input {
            width: 100%;
            height: calc(100% - 72px);
            min-height: 4em;
        }

        #html {
            margin: 0 8px;
            min-height: 4em;
            display: block;
            height: 50%;
        }

        .border-text-box {
            border-style: solid;
            border-color: black;
            border-width: 1px;
            padding: 8px;
            overflow: auto;
        }

        #html-content {
            height: calc(100% - 72px);
        }

        #display {
            margin: 0 8px;
            height: 100%;
        }

        #display-content {
            height: calc(100% - 72px);
            overflow: auto;
            line-height: 1.8;
            /*font-family: "Biaodian Pro Serif", "Biaodian Pro Serif CNS", "Biaodian Serif", "Times", serif;*/
            /*text-align: justify;*/
        }

        @media (max-width: 768px) {
            .column {
                width: 100%;
            }
        }
    </style>

    <!-- Javascript -->

    <script>

      let DEFAULT_LANG = 'zht';

      let LANGS = [
        'en', 'zhs', 'zht', 'ja'
      ];

      let UI_STRINGS = {
        // 'title': {
        //   en: 'Demo',
        //   zhs: '演示',
        //   zht: '演示',
        //   ja: 'デモ'
        // },
        'markdown-title': {
          en: 'Markdown Input',
          zhs: 'Markdown Input',
          zht: 'Markdown Input',
          ja: 'Markdown Input'
        },
        'html-title': {
          en: 'HTML Output',
          zhs: 'HTML Output',
          zht: 'HTML Output',
          ja: 'HTML Output'
        },
        'preview-title': {
          en: 'Preview',
          zhs: 'Preview',
          zht: 'Preview',
          ja: 'Preview'
        },
        'action-preview': {
          en: 'Preview',
          zhs: 'Preview',
          zht: 'Preview',
          ja: 'Preview'
        }
      };

      let SAMPLES = {
        'en': `
Download
--------

[Markdown 1.0.1][dl] (18 KB) -- 17 Dec 2004

[dl]: http://daringfireball.net/projects/downloads/Markdown_1.0.1.zip


Introduction
------------

Markdown is a text-to-HTML conversion tool for web writers. Markdown
allows you to write using an easy-to-read, easy-to-write plain text
format, then convert it to structurally valid XHTML (or HTML).

Thus, "Markdown" is two things: (1) a plain text formatting syntax;
and (2) a software tool, written in Perl, that converts the plain text
formatting to HTML. See the [Syntax][] page for details pertaining to
Markdown's formatting syntax. You can try it out, right now, using the
online [Dingus][].

  [syntax]: /projects/markdown/syntax
  [dingus]: /projects/markdown/dingus

The overriding design goal for Markdown's formatting syntax is to make
it as readable as possible. The idea is that a Markdown-formatted
document should be publishable as-is, as plain text, without looking
like it's been marked up with tags or formatting instructions. While
Markdown's syntax has been influenced by several existing text-to-HTML
filters, the single biggest source of inspiration for Markdown's
syntax is the format of plain text email.

The best way to get a feel for Markdown's formatting syntax is simply
to look at a Markdown-formatted document. For example, you can view
the Markdown source for the article text on this page here:
<http://daringfireball.net/projects/markdown/index.text>

(You can use this '.text' suffix trick to view the Markdown source for
the content of each of the pages in this section, e.g. the
[Syntax][s_src] and [License][l_src] pages.)

  [s_src]: /projects/markdown/syntax.text
  [l_src]: /projects/markdown/license.text

Markdown is free software, available under a BSD-style open source
license. See the [License] [pl] page for more information.

  [pl]: /projects/markdown/license


Discussion List <a id="discussion-list" />
---------------

I've set up a public [mailing list for discussion about Markdown] [ml].
Any topic related to Markdown -- both its formatting syntax and
its software -- is fair game for discussion. Anyone who is interested
is welcome to join.

It's my hope that the mailing list will lead to good ideas for future
improvements to Markdown.

  [ml]: http://six.pairlist.net/mailman/listinfo/markdown-discuss


Installation and Requirements <a id="install" />
-----------------------------

Markdown requires Perl 5.6.0 or later. Welcome to the 21st Century.
Markdown also requires the standard Perl library module [Digest::MD5]
[md5], which is probably already installed on your server.

  [md5]: http://search.cpan.org/dist/Digest-MD5/MD5.pm


### Movable Type ###

Markdown works with Movable Type version 2.6 or later (including
Movable Type 3.0).

1.  Copy the "Markdown.pl" file into your Movable Type "plugins"
	directory. The "plugins" directory should be in the same directory
	as "mt.cgi"; if the "plugins" directory doesn't already exist, use
	your FTP program to create it. Your installation should look like
	this:

        (mt home)/plugins/Markdown.pl

2.  Once installed, Markdown will appear as an option in Movable Type's
	Text Formatting pop-up menu. This is selectable on a per-post basis:

	![Screenshot of Movable Type 'Text Formatting' Menu][tfmenu]

	Markdown translates your posts to HTML when you publish; the posts
	themselves are stored in your MT database in Markdown format.

3.	If you also install SmartyPants 1.5 (or later), Markdown will
	offer a second text formatting option: "Markdown With
	SmartyPants". This option is the same as the regular "Markdown"
	formatter, except that it automatically uses SmartyPants to create
	typographically correct curly quotes, em-dashes, and ellipses. See
	the [SmartyPants web page][sp] for more information.

4.	To make Markdown (or "Markdown With SmartyPants") your default
	text formatting option for new posts, go to Weblog Config:
	Preferences.

Note that by default, Markdown produces XHTML output. To configure
Markdown to produce HTML 4 output, see "Configuration", below.

  [sp]: http://daringfireball.net/projects/smartypants/



### Blosxom ###

Markdown works with Blosxom version 2.0 or later.

1.  Rename the "Markdown.pl" plug-in to "Markdown" (case is
    important). Movable Type requires plug-ins to have a ".pl"
    extension; Blosxom forbids it.

2.  Copy the "Markdown" plug-in file to your Blosxom plug-ins folder.
    If you're not sure where your Blosxom plug-ins folder is, see the
    Blosxom documentation for information.

3.  That's it. The entries in your weblog will now automatically be
	processed by Markdown.

4.	If you'd like to apply Markdown formatting only to certain
	posts, rather than all of them, Markdown can optionally be used in
	conjunction with Blosxom's [Meta][] plug-in. First, install the
	Meta plug-in. Next, open the Markdown plug-in file in a text
	editor, and set the configuration variable \`$g_blosxom_use_meta\`
	to 1. Then, simply include a "\`meta-markup: Markdown\`" header line
	at the top of each post you compose using Markdown.

  [meta]: http://www.blosxom.com/plugins/meta/meta.htm


### BBEdit ###

Markdown works with BBEdit 6.1 or later on Mac OS X. It also works
with BBEdit 5.1 or later and MacPerl 5.6.1 on Mac OS 8.6 or later. If
you're running Mac OS X 10.2 (Jaguar), you may need to install the
Perl module [Digest::MD5] [md5] from CPAN; Digest::MD5 comes
pre-installed on Mac OS X 10.3 (Panther).

1.  Copy the "Markdown.pl" file to appropriate filters folder in your
	"BBEdit Support" folder. On Mac OS X, this should be:

        BBEdit Support/Unix Support/Unix Filters/

    See the BBEdit documentation for more details on the location of
    these folders.

    You can rename "Markdown.pl" to whatever you wish.

2.  That's it. To use Markdown, select some text in a BBEdit document,
	then choose Markdown from the Filters sub-menu in the "#!" menu, or
	the Filters floating palette



Configuration  <a id="configuration"></a>
-------------

By default, Markdown produces XHTML output for tags with empty elements.
E.g.:

    <br />

Markdown can be configured to produce HTML-style tags; e.g.:

    <br>


### Movable Type ###

You need to use a special \`MTMarkdownOptions\` container tag in each
Movable Type template where you want HTML 4-style output:

    <MTMarkdownOptions output='html4'>
        ... put your entry content here ...
    </MTMarkdownOptions>

The easiest way to use MTMarkdownOptions is probably to put the
opening tag right after your \`<body>\` tag, and the closing tag right
before \`</body>\`.

To suppress Markdown processing in a particular template, i.e. to
publish the raw Markdown-formatted text without translation into
(X)HTML, set the \`output\` attribute to 'raw':

    <MTMarkdownOptions output='raw'>
        ... put your entry content here ...
    </MTMarkdownOptions>


### Command-Line ###

Use the \`--html4tags\` command-line switch to produce HTML output from a
Unix-style command line. E.g.:

    % perl Markdown.pl --html4tags foo.text

Type \`perldoc Markdown.pl\`, or read the POD documentation within the
Markdown.pl source code for more information.


Acknowledgements <a id="acknowledgements" />
----------------

[Aaron Swartz][] deserves a tremendous amount of credit for his feedback on the
design of Markdown's formatting syntax. Markdown is *much* better thanks
to Aaron's ideas, feedback, and testing. Also, Aaron's [html2text][]
is a very handy (and free) utility for turning HTML into
Markdown-formatted plain text.

[Nathaniel Irons][], [Dan Benjamin][], [Daniel Bogan][], and [Jason Perkins][]
also deserve thanks for their feedback.

[Michel Fortin][] has ported Markdown to PHP; it's a splendid port, and highly recommended for anyone looking for a PHP implementation of Markdown.

  [Aaron Swartz]:		http://www.aaronsw.com/
  [Nathaniel Irons]:	http://bumppo.net/
  [Dan Benjamin]:		http://hivelogic.com/
  [Daniel Bogan]:		http://waferbaby.com/
  [Jason Perkins]:		http://pressedpants.com/
  [Michel Fortin]:		http://www.michelf.com/projects/php-markdown/
  [html2text]:          http://www.aaronsw.com/2002/html2text/

  [tfmenu]: /graphics/markdown/mt_textformat_menu.png
`,
        'zhs': `# Markdown 是什么

Markdown是一种轻量级*:标记/biāojì/语言/yǔyán/:*，创始人为[约翰·格鲁伯](https://zh.wikipedia.org/wiki/約翰·格魯伯)（英语：John Gruber）。它允许人们使用*易读易写*的纯文本格式编写文档，然后转换成有效的XHTML（或者HTML）文档。这种语言吸收了很多在电子邮件中已有的纯文本标记的特性。

由于Markdown的_:轻量化、易读易写:_特性，并且对于**图片，图表、数学式**都有支持，目前许多网站都广泛使用Markdown来撰写~~帮助~~文档或是用于论坛上发表消息。如GitHub、Reddit、Diaspora、Stack Exchange、OpenStreetMap 、SourceForge、简书等，甚至还能被使用来撰写电子书。`,
        'zht': `# Markdown 是什麽

Markdown是壹種輕量級*:標記/biāojì/語言/yǔyán/:*，創始人為[約翰·格魯伯](https://zh.wikipedia.org/wiki/約翰·格魯伯)（英語：John Gruber）。它允許人們使用*易讀易寫*的純文本格式編寫文檔，然後轉換成有效的XHTML（或者HTML）文檔。這種語言吸收了很多在電子郵件中已有的純文本標記的特性。

由於Markdown的_:輕量化、易讀易寫:_特性，並且對於**圖片，圖表、數學式**都有支持，目前許多網站都廣泛使用Markdown來撰寫~~幫助~~文檔或是用於論壇上發表消息。如GitHub、Reddit、Diaspora、Stack Exchange、OpenStreetMap 、SourceForge、簡書等，甚至還能被使用來撰寫電子書。`,
        'ja': `# Markdownの概要

*:Markdown/マークダウン/:*は、文書を記述するための*軽量*マークアップ言語のひとつである。本来は_:プレーンテキスト形式で:_手軽に書いた文書からHTMLを生成するために***:開/かい/発/はつ/:***されたものである。しかし、現在ではHTMLのほかパワーポイント形式やLaTeX形式のファイルへ変換するソフトウェア（コンバータ）も開発されている。各コンバータの開発者によって多様な拡張が施されるため、各種の方言が存在する。`
      };

      let selectedLang = DEFAULT_LANG;
      let useHanCss = true;

      function _selectLanguage(language) {
        // translate document
        for (var key in UI_STRINGS) {
          if (UI_STRINGS.hasOwnProperty(key)) {
            let uiString = UI_STRINGS[key][language];
            if (uiString === undefined) uiString = UI_STRINGS[key][DEFAULT_LANG];
            document.querySelector(`[name=${key}]`).innerHTML = uiString;
          }
        }

        // change button states
        LANGS.forEach(function(lang) {
          let selector = `#languages [name=${lang}]`;
          let languageButton = document.querySelector(selector);
          if (!languageButton) throw `${selector} is null`;
          if (lang !== language) {
            languageButton.classList.remove('is-black');
          } else {
            languageButton.classList.add('is-black');
          }
        });

        selectedLang = language;
      }

      function selectLanguage(language) {
        _selectLanguage(language);
        console.log(`Selected Language: ${language}`);

        // load sample and convert to markdown
        loadSample(language);
        convertToMarkdown();
      }

      function loadSample(language) {
        let sample;
        if (typeof SAMPLES[language] !== 'undefined') {
          sample = SAMPLES[language];
        } else {
          sample = SAMPLES[DEFAULT_LANG];
        }
        document.getElementById('markdown-input').value = sample;
      }

      function convertToMarkdown() {
        let mdDocument = document.getElementById('markdown-input').value;
        console.log(mdDocument);
        let html = marked(mdDocument);
        document.getElementById('html-content').innerText = html;
        document.getElementById('display-content').innerHTML = html;
        // render Han.css
        let hanStylesheet = document.styleSheets[0];
        let displayContent = document.querySelector('#display-content');
        if (selectedLang === 'ja') {
          displayContent.setAttribute('lang', 'ja');
        } else {
          displayContent.setAttribute('lang', 'zh-Hans');
        }

        if (useHanCss) {
          hanStylesheet.disabled = false;
          Han(displayContent)
            .initCond().render();
            // .renderElem()
            // .renderJiya()
            // .renderHWS();
        } else {
          hanStylesheet.disabled = true;
          // Han(document.querySelector('#display-content'))
          //   .initCond();
        }
      }

      function toggleHanCssFeature(use) {
        useHanCss = use;
        convertToMarkdown();
      }

      window.addEventListener('load', function() {
        console.log('Page loaded...');

        // init
        selectLanguage(DEFAULT_LANG);
        loadSample(DEFAULT_LANG);
        convertToMarkdown();

        document.getElementById('action').onclick = function(_) {
          convertToMarkdown();
        };

        LANGS.forEach(function(lang) {
          let selector = `#languages [name=${lang}]`;
          let languageButton = document.querySelector(selector);
          languageButton.onclick = function(_) {
            selectLanguage(lang);
          };
        });

        let hanCssToggle = document.querySelector('#han-css-toggle');
        hanCssToggle.addEventListener('change', function() {
          console.log(`this.checked = ${this.checked}`)
          toggleHanCssFeature(this.checked);
        })
      });
    </script>

</head>


<!-- HTML Body -->

<body>
<div class="content">
    <div class="header">
        <div class="level">

            <div class="level-left">
                <div id="title" class="level-item">
                    <img src="img/markdown-han-logo.svg" width="160px" height="160px">
                </div>
            </div>
            <div class="level-right">
                <!-- TODO: uncomment Github badge -->
                <!--<div class="level-item">-->
                <!--<a class="github-button" href="https://github.com/zhenalexfan/marked"-->
                <!--data-color-scheme="no-preference: dark; light: dark; dark: dark;" data-size="large"-->
                <!--aria-label="Star zhenalexfan/marked on GitHub">Star</a>-->
                <!--</div>-->

                <div class="level-item">
                    <div id="languages" class="buttons has-addons is-left">
                        <button class="button is-small is-active" name="en">English</button>
                        <button class="button is-small is-active" name="zhs">中文简体</button>
                        <button class="button is-small is-active" name="zht">中文繁體</button>
                        <button class="button is-small is-active" name="ja">日本語</button>
                    </div>
                </div>
            </div>
        </div>


        <div class="intro">
            <p>MarkdownHan is an extension to Markdown featuring HTML <code>&lt;ruby&gt;</code> tag and more. </p>
        </div>

    </div>


    <div id="columns">
        <div class="column left">

            <!-- markdown -->
            <div id="markdown">
                <h2 name="markdown-title">
                </h2>
                <div class="textarea-wrapper">
                    <textarea id="markdown-input" lang="zh-Hans" class="code border-text-box"></textarea>
                    <button id="action" class="button is-black" name="action-preview" style="width: 6em">
                    </button>
                </div>
            </div>

            <!-- html -->
            <div id="html">
                <h2 name="html-title">
                </h2>
                <div id="html-content" lang="zh-Hans" class="code border-text-box">
                </div>
            </div>

        </div>

        <div class="column right">

            <!-- result -->
            <div id="display" class="han-init-context">
                <div class="media">
                    <div class="media-content"><h2 name="preview-title">
                    </h2></div>
                    <div class="media-right">
                        <label class="checkbox">
                            <input id="han-css-toggle" type="checkbox" checked>
                            Use <a href="https://hanzi.pro/">Han.css (@ethantw)</a>
                        </label>
                    </div>
                </div>
                <div id="display-content" class="border-text-box" lang="ja"></div>
            </div>
        </div>

    </div>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/Han/3.2.7/han.min.js"></script>
</body>


</html>
