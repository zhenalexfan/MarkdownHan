<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bulma -->
    <link rel="stylesheet" media="all" href="https://cdn.jsdelivr.net/npm/bulma@0.8.2/css/bulma.min.css">
    <!-- Han.css/CSS -->
    <link rel="stylesheet" media="all" href="https://cdnjs.cloudflare.com/ajax/libs/Han/3.3.0/han.min.css">
    <!-- Marked -->
    <script src="../lib/marked.js"></script>

    <style>

        #title {
            padding: 16px 0;
            text-align: center;
            margin: 0 8px;
            height: 72px;
        }

        h2 {
            height: 36px;
        }

        #columns {
            height: calc(100% - 72px - 16px - 38px - 16px);
        }

        .content {
            margin: 0 8px;
        }

        .column {
            float: left;
            height: 100%;
        }

        .column.left {
            width: 50%;
        }

        .column.right {
            width: 50%;
        }

        .code {
            font-family: "Roboto Mono", "SF Mono", Menlo, Courier, monospace;
            font-size: 0.8em;
            line-height: 1.4;
        }

        #markdown .buttons {
            align-items: start;
            display: block;
            float: right;
            padding: 8px 0;
            height: 72px;
        }

        #markdown {
            margin: 0 8px;
            height: 50%;
        }

        #markdown-input {
            width: 100%;
            height: calc(100% - 36px - 72px);
            min-height: 4em;
            border-style: solid;
            border-width: 1px;
        }

        #html {
            margin: 0 8px;
            min-height: 4em;
            display: block;
            height: 50%;
        }

        #html-content {
            height: calc(100% - 36px);
            border-style: solid;
            border-color: #cccccc;
            border-width: 1px;
            padding: 4px;
            overflow: auto;
        }

        #display {
            margin: 0 8px;
            height: 100%;
        }

        #display-content {
            height: calc(100% - 36px);
            border-style: solid;
            border-color: #cccccc;
            border-width: 1px;
            padding: 4px;
            overflow: auto;
            line-height: 1.8;
            /*text-align: justify;*/
        }
    </style>

    <script>

      let DEFAULT_LANG = 'zht';

      let LANGS = [
        'en', 'zhs', 'zht', 'ja'
      ];

      let UI_STRINGS = {
        'title': {
          en: 'Demo',
          zhs: '演示',
          zht: '演示',
          ja: 'デモ'
        },
        'markdown-title': {
          en: 'Markdown Input',
          zhs: 'Markdown输入',
          zht: 'Markdown輸入',
          ja: 'Markdownの入力'
        },
        'html-title': {
          en: 'HTML Output',
          zhs: 'HTML输出',
          zht: 'HTML輸出',
          ja: 'HTMLの出力'
        },
        'preview-title': {
          en: 'Preview',
          zhs: '预览',
          zht: '預覽',
          ja: '内検'
        },
        'action-preview': {
          en: 'Preview',
          zhs: '预览',
          zht: '預覽',
          ja: '内検'
        }
      };

      let SAMPLES = {
        'en': '',
        'zhs': `# 超文本标记语言

***:超/Chāo/文本/Wénběn/标记/Biāojì/:*语言**（英语：HyperText Markup Language，简称：HTML）是一种用于创建网页的标准*标记语言*。HTML是一种_:基础:__:技术:_，常与CSS、JavaScript一起被众多网站用于设计网页、网页应用程序以及移动应用程序的用户界面。[网页*:浏览/Liúlǎn/器/Qì/:*](https://zh.wikipedia.org/wiki/%E7%BD%91%E9%A1%B5%E6%B5%8F%E8%A7%88%E5%99%A8)可以*读取*HTML文件，并将其渲染成_:可视化:__:网页:_。HTML描述了一个网站的*结构语义*随著线索的呈现，使之成为一种标记语言~~而非编程语言~~。

## 元素的属性

许多**元素**存在一些*共通*的*:属性/Shǔxìng/:*：

- \`id\`属性为元素提供了在全文档内的唯一标识。它用于*识别元素*，以便样式表可以改变其表现属性，脚本可以改变、显示或删除其内容或格式化。
- \`class\`属性提供一种将类似元素分类的方式。常被用于_:语义化:_或_:格式化:_。例如，一个HTML文档可指定类\`<class="标记">\`来表明所有具有这一类值的元素都从属于文档的主文本。

大多数元素采用与语言相关的属性\`dir\`来*指定[文字*:_:方向:_/Fāngxiàng/:*](https://zh.wikipedia.org/wiki/%E6%9D%B1%E4%BA%9E%E6%96%87%E5%AD%97%E6%8E%92%E5%88%97%E6%96%B9%E5%90%91)*，如\`rtl\`采用从右到左的文本，比如阿拉伯语、波斯语以及希伯来语。
`,
        'zht': `# 超文本標記語言

***:超/Chāo/文本/Wénběn/標記/Biāojì/:*語言**（英語：HyperText Markup Language，簡稱：HTML）是壹種用於創建網頁的標準*標記語言*。HTML是壹種_:基礎:__:技術:_，常與CSS、JavaScript壹起被眾多網站用於設計網頁、網頁應用程序以及移動應用程序的用戶界面。[網頁*:瀏覽/Liúlǎn/器/Qì/:*](https://zh.wikipedia.org/wiki/%E7%BD%91%E9%A1%B5%E6%B5%8F%E8%A7%88%E5%99%A8)可以*讀取*HTML文件，並將其渲染成_:可視化:__:網頁:_。HTML描述了壹個網站的*結構語義*隨著線索的呈現，使之成為壹種標記語言~~而非編程語言~~。

## 元素的屬性

許多**元素**存在壹些*共通*的*:屬性/Shǔxìng/:*：

- \`id\`屬性為元素提供了在全文檔內的唯壹標識。它用於*識別元素*，以便樣式表可以改變其表現屬性，腳本可以改變、顯示或刪除其內容或格式化。
- \`class\`屬性提供壹種將類似元素分類的方式。常被用於_:語義化:_或_:格式化:_。例如，壹個HTML文檔可指定類\`<class="標記">\`來表明所有具有這壹類值的元素都從屬於文檔的主文本。

大多數元素采用與語言相關的屬性\`dir\`來*指定[文字*:_:方向:_/Fāngxiàng/:*](https://zh.wikipedia.org/wiki/%E6%9D%B1%E4%BA%9E%E6%96%87%E5%AD%97%E6%8E%92%E5%88%97%E6%96%B9%E5%90%91)*，如\`rtl\`采用從右到左的文本，比如阿拉伯語、波斯語以及希伯來語。
`,
        'ja': `# 平仮名

***:平/ひら/仮名/がな/:***は、日本語の*表記*に用いられる[音節文字](https://ja.wikipedia.org/wiki/%E9%9F%B3%E7%AF%80%E6%96%87%E5%AD%97)。かなの一種で、借字（万葉仮名）を起源として成立した。借字として使われる_:漢字:_を、極度に草体化したものである。

## 概要

現在の日本語で最も基本的な文字であり、主に次のような場面で用いられる。

- **文章の表記に**用いる場合
    - 仮名交じり文
    - 漢字表記が無い*和語*を表す場合
    - 漢字表記がある単語でも、漢字が常用漢字に含まれていないなど、読み書きしづらい場合
- 音を示すことを目的とする場合
    - 漢字の訓（訓読み、振り仮名・ルビを参照）
    - 日本語の初学者を対象とする、他の文字の代替
- [書道](https://ja.wikipedia.org/wiki/%E6%9B%B8%E9%81%93)の一分野であるかなに用いる場合
- 人名につけられることがある
`
      };

      function _selectLanguage(language) {
        // translate document
        for (var key in UI_STRINGS) {
          if (UI_STRINGS.hasOwnProperty(key)) {
            let uiString = UI_STRINGS[key][language];
            if (!uiString) uiString = UI_STRINGS[key][DEFAULT_LANG];
            document.querySelector(`[name=${key}]`).innerHTML = uiString;
          }
        }

        // change button states
        LANGS.forEach(function(lang) {
          let selector = `#languages [name=${lang}]`;
          let languageButton = document.querySelector(selector);
          if (!languageButton) throw `${selector} is null`;
          if (lang != language) {
            languageButton.classList.remove('is-light');
          } else {
            languageButton.classList.add('is-light');
          }
        });
      }

      function selectLanguage(language) {
        _selectLanguage(language);
        console.log(`Selected Language: ${language}`);

        // load sample and convert to markdown
        loadSample(language);
        convertToMarkdown();
      }

      function loadSample(language) {
        let sample;
        if (SAMPLES[language] != undefined) {
          sample = SAMPLES[language];
        } else {
          sample = SAMPLES[DEFAULT_LANG];
        }
        document.getElementById('markdown-input').value = sample;
      }

      function convertToMarkdown() {
        let mdDocument = document.getElementById('markdown-input').value;
        console.log(mdDocument);
        let html = marked(mdDocument);
        document.getElementById('html-content').innerText = html;
        document.getElementById('display-content').innerHTML = html;
        // render Han.css
        Han(document.querySelector('#display-content'))
          // .render();
          .initCond()
          .renderElem()
          .renderJiya()
          .renderHWS();
      }

      window.addEventListener('load', function() {
        console.log('Page loaded...');

        // init
        selectLanguage(DEFAULT_LANG);
        loadSample(DEFAULT_LANG);
        convertToMarkdown();

        document.getElementById('action').onclick = function(_) {
          convertToMarkdown();
        };

        LANGS.forEach(function(lang) {
          let selector = `#languages [name=${lang}]`;
          let languageButton = document.querySelector(selector);
          languageButton.onclick = function(_) {
            selectLanguage(lang);
          };
        });
      });
    </script>

</head>

<body>
<div class="content" lang="zh-Hans">
    <h1 id="title" name="title">
    </h1>

    <div id="languages" class="buttons has-addons is-centered">
        <button class="button is-small" name="en">English</button>
        <button class="button is-small" name="zhs">中文简体</button>
        <button class="button is-small" name="zht">中文繁體</button>
        <button class="button is-small" name="ja">日本語</button>
    </div>

    <div id="columns">
        <div class="column left">
            <div id="markdown">
                <h2 name="markdown-title">
                </h2>
                <textarea id="markdown-input" lang="zh-Hans" class="code"></textarea>
                <div class="buttons">
                    <button id="action" class="button is-black" name="action-preview" style="width: 6em">

                    </button>
                </div>
            </div>

            <div id="html">
                <h2 name="html-title">
                </h2>
                <div id="html-content" lang="zh-Hans" class="code">
                </div>
            </div>
        </div>

        <div class="column right">
            <div id="display" lang="zh-Hans" class="han-init-context">
                <h2 name="preview-title">
                </h2>
                <div id="display-content"></div>
            </div>
        </div>

    </div>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/Han/3.2.7/han.min.js"></script>
</body>


</html>
